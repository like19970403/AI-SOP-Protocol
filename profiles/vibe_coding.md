# Vibe Coding — 規格驅動開發策略

適用：以「AI 餵食者 + 品質守門員」角色最大化輸出效率。
載入條件：`workflow: vibe-coding`

---

## 角色分工

```
人類（決策者）              AI（實作者）
─────────────────────────────────────
撰寫 SPEC-002 ────────→  執行 SPEC-001 中
確認設計方案  ←────────  規格複述 + 計畫
驗收成果      ←────────  Done Checklist
撰寫 SPEC-003 ────────→  執行 SPEC-002 中
```

核心原則：人類決策與 AI 實作的節奏**不互相等待**。

---

## AI 執行規則

拿到 SPEC 後：

1. **複述理解**：一段話說明 Goal 和 Done When 的理解
2. **列出計畫**：修改的檔案清單與修改理由
3. **等待確認**（HITL: standard / strict 時）
4. **自我驗收**：執行 Done When 清單並回報結果

---

## HITL 等級

```yaml
hitl: minimal   # 僅副作用前暫停（適合熟悉任務）
hitl: standard  # 每個實作計畫需確認（預設）
hitl: strict    # 每個檔案修改需確認（涉及生產/安全系統）
```

**任何 HITL 等級下都必須暫停的情況：**
- 刪除現有代碼（非新增）
- 修改共用介面或 API 合約
- 觸及 auth / crypto 相關模組
- 版本發布（tag、publish）

---

## Context 切換程序

切換功能模組時：

```
切換前：摘要目前狀態（完成了什麼、未完成什麼）
切換後：讀取新模組的 ADR → 確認測試基線通過
```

長對話管理：超過 50 回合的對話，重新讀取 CLAUDE.md。

---

## 模型選擇策略

| 任務類型 | 建議層級 | 理由 |
|----------|---------|------|
| 架構設計、ADR 撰寫 | 強（Opus/Sonnet） | 需要深度推理 |
| 樣板代碼、重複性生成 | 輕（Haiku） | 省 Token |
| 單元測試 | 中 | 結構化但需理解上下文 |
| 文件整理 | 輕 | 格式化工作 |

---

## Rate Limit 保護

```
觸發 Rate Limit 時：
  → 切換至文件工作（寫 SPEC、更新 ADR）
  → 此為有效利用等待時間，非浪費

並行準備原則：
  AI 執行 TASK-A 時，人類已在準備 TASK-B 的 SPEC。
  TASK-A 完成 → 立刻丟入 TASK-B，無等待。
```

使用 `make session-checkpoint NEXT="下一個任務描述"` 在切換前儲存進度。
